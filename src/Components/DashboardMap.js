import React from 'react'
import { MapContainer, TileLayer, Marker, Popup, Polygon } from "react-leaflet";
import "leaflet/dist/leaflet.css";
import L from "leaflet";

// Fix Leaflet marker icon issue
delete L.Icon.Default.prototype._getIconUrl;
L.Icon.Default.mergeOptions({
  iconUrl: "https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",
  iconRetinaUrl: "https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png",
  shadowUrl: "https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png",
});


export const DashboardMap = () => {
    const dhakaNorthCoords = [
        [23.8992919921875, 90.44189453125],
        [23.89910888671875, 90.4425048828125],
        [23.89910888671875, 90.44329833984375],
        [23.898681640625, 90.44390869140625],
        [23.8983154296875, 90.44488525390625],
        [23.8980712890625, 90.4459228515625],
        [23.897705078125, 90.4468994140625],
        [23.89727783203125, 90.44732666015625],
        [23.8970947265625, 90.4478759765625],
        [23.89630126953125, 90.44873046875],
        [23.8961181640625, 90.44952392578125],
        [23.89569091796875, 90.45111083984375],
        [23.8955078125, 90.453125],
        [23.8958740234375, 90.45452880859375],
        [23.8958740234375, 90.455078125],
        [23.8958740234375, 90.45587158203125],
        [23.8961181640625, 90.4569091796875],
        [23.8961181640625, 90.45770263671875],
        [23.8961181640625, 90.45867919921875],
        [23.89532470703125, 90.45892333984375],
        [23.89471435546875, 90.45947265625],
        [23.894287109375, 90.45989990234375],
        [23.89410400390625, 90.46051025390625],
        [23.89349365234375, 90.4613037109375],
        [23.89288330078125, 90.46173095703125],
        [23.89251708984375, 90.46112060546875],
        [23.8917236328125, 90.460693359375],
        [23.89093017578125, 90.460693359375],
        [23.89031982421875, 90.460693359375],
        [23.889892578125, 90.46112060546875],
        [23.888916015625, 90.46173095703125],
        [23.8883056640625, 90.4613037109375],
        [23.88787841796875, 90.46087646484375],
        [23.8873291015625, 90.46087646484375],
        [23.886474609375, 90.460693359375],
        [23.8861083984375, 90.460693359375],
        [23.885498046875, 90.460693359375],
        [23.8848876953125, 90.4603271484375],
        [23.88427734375, 90.4603271484375],
        [23.88372802734375, 90.46087646484375],
        [23.88311767578125, 90.46148681640625],
        [23.8826904296875, 90.4619140625],
        [23.882080078125, 90.46209716796875],
        [23.88153076171875, 90.46209716796875],
        [23.88092041015625, 90.46173095703125],
        [23.88031005859375, 90.4613037109375],
        [23.87969970703125, 90.46087646484375],
        [23.87890625, 90.46087646484375],
        [23.87847900390625, 90.46112060546875],
        [23.8779296875, 90.4619140625],
        [23.877685546875, 90.462890625],
        [23.87750244140625, 90.46368408203125],
        [23.8773193359375, 90.46429443359375],
        [23.87652587890625, 90.46490478515625],
        [23.87567138671875, 90.46527099609375],
        [23.87451171875, 90.46612548828125],
        [23.8739013671875, 90.4666748046875],
        [23.87310791015625, 90.467529296875],
        [23.8726806640625, 90.46807861328125],
        [23.872314453125, 90.4688720703125],
        [23.87109375, 90.47027587890625],
        [23.8707275390625, 90.470703125],
        [23.8701171875, 90.4713134765625],
        [23.86907958984375, 90.471923828125],
        [23.867919921875, 90.47247314453125],
        [23.86627197265625, 90.47308349609375],
        [23.86590576171875, 90.47308349609375],
        [23.86492919921875, 90.472900390625],
        [23.86370849609375, 90.47271728515625],
        [23.8626708984375, 90.472900390625],
        [23.86187744140625, 90.47308349609375],
        [23.85992431640625, 90.472900390625],
        [23.85888671875, 90.47247314453125],
        [23.85791015625, 90.4744873046875],
        [23.8551025390625, 90.4744873046875],
        [23.85430908203125, 90.4744873046875],
        [23.8519287109375, 90.47430419921875],
        [23.85089111328125, 90.473876953125],
        [23.848876953125, 90.4735107421875],
        [23.84869384765625, 90.47332763671875],
        [23.84808349609375, 90.47332763671875],
        [23.84747314453125, 90.47308349609375],
        [23.846923828125, 90.472900390625],
        [23.84613037109375, 90.47271728515625],
        [23.84552001953125, 90.47271728515625],
        [23.84527587890625, 90.47247314453125],
        [23.8441162109375, 90.47271728515625],
        [23.843505859375, 90.47271728515625],
        [23.8428955078125, 90.47271728515625],
        [23.84228515625, 90.47271728515625],
        [23.8416748046875, 90.47308349609375],
        [23.84088134765625, 90.47369384765625],
        [23.840087890625, 90.47430419921875],
        [23.83929443359375, 90.47491455078125],
        [23.83868408203125, 90.47589111328125],
        [23.837890625, 90.4766845703125],
        [23.83709716796875, 90.477294921875],
        [23.8363037109375, 90.47747802734375],
        [23.8353271484375, 90.4779052734375],
        [23.83428955078125, 90.478271484375],
        [23.83367919921875, 90.47869873046875],
        [23.8331298828125, 90.47967529296875],
        [23.832275390625, 90.48089599609375],
        [23.83172607421875, 90.4813232421875],
        [23.83148193359375, 90.481689453125],
        [23.8306884765625, 90.48248291015625],
        [23.8306884765625, 90.48309326171875],
        [23.8306884765625, 90.48388671875],
        [23.831298828125, 90.48431396484375],
        [23.8319091796875, 90.48468017578125],
        [23.832275390625, 90.48529052734375],
        [23.832275390625, 90.486083984375],
        [23.83148193359375, 90.4866943359375],
        [23.83087158203125, 90.48687744140625],
        [23.830078125, 90.48687744140625],
        [23.82952880859375, 90.48712158203125],
        [23.8284912109375, 90.4873046875],
        [23.827880859375, 90.4873046875],
        [23.8272705078125, 90.48748779296875],
        [23.826904296875, 90.4876708984375],
        [23.825927734375, 90.48809814453125],
        [23.8250732421875, 90.48828125],
        [23.82427978515625, 90.48809814453125],
        [23.823486328125, 90.48748779296875],
        [23.8228759765625, 90.48712158203125],
        [23.82171630859375, 90.48687744140625],
        [23.8206787109375, 90.4866943359375],
        [23.81951904296875, 90.4866943359375],
        [23.8184814453125, 90.4866943359375],
        [23.81787109375, 90.48687744140625],
        [23.81768798828125, 90.4876708984375],
        [23.81768798828125, 90.48828125],
        [23.81787109375, 90.48907470703125],
        [23.8165283203125, 90.490478515625]
      ];
    
      const dhakaSouthCoords = [
        [23.75, 90.35],
        [23.75, 90.45],
        [23.85, 90.45],
        [23.85, 90.35],
        [23.75, 90.35],
      ];
    
      const markers = [
        { coords: [23.82, 90.41], name: "Slum 1", vulnerability: "High" },
        { coords: [23.77, 90.43], name: "Slum 2", vulnerability: "Low" },
      ];
    
  return (
    <div style={{ flex: 1 }}>
          <MapContainer
            center={[23.8103, 90.4125]}
            zoom={11}
            style={{ height: "500px", width: "100%", borderRadius: "10px" }}
          >
            {/* OpenStreetMap Tile Layer */}
            <TileLayer
              url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
              attribution='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            />

            {/* Dhaka North Boundary */}
            <Polygon
              pathOptions={{ fillColor: "#6A5ACD", color: "#6A5ACD" }}
              positions={dhakaNorthCoords}
            >
              <Popup>Dhaka North Zone</Popup>
            </Polygon>

            {/* Dhaka South Boundary */}
            <Polygon
              pathOptions={{ fillColor: "#FFD700", color: "#FFD700" }}
              positions={dhakaSouthCoords}
            >
              <Popup>Dhaka South Zone</Popup>
            </Polygon>

            {/* Markers for slum locations */}
            {markers.map((marker, index) => (
              <Marker key={index} position={marker.coords}>
                <Popup>
                  <h4>{marker.name}</h4>
                  <p>Vulnerability: {marker.vulnerability}</p>
                </Popup>
              </Marker>
            ))}
          </MapContainer>
        </div>
  )
}
